# 总的注意：

如果创建了泛型并且在整个程序中一直存在，记得要添加删除步骤，让程序的鲁棒性更好，不然就会出现打开两次数据后，dataGridView反而会重复显示数据，主要是因为List还保留上一次的数据

![72171500743](总复习.assets\1721715007430.png)







------

注意对象的深层引用，下面是正确的创建一个新的泛型，并且两个泛型之间不会互相干扰

![72171514873](总复习.assets\1721715148733.png)

下面这种是错误的。同理，单独的Point也不能之间等于![72171533914](总复习.assets\1721715339140.png)

------





让dataGridView和richTextBox紧紧贴紧窗口：

把布局里面的Anchor选择四个方向，不仅仅是dataGridView和richTextBox要这样，tabControl也要，因为那两个镶嵌在里面

：![72171970564](总复习.assets\1721719705644.png)





怎么画图：

首先把toolStrip1的 ImageScalingSize 改成50，这里推荐50，刚刚好。

![72196513243](总复习.assets\1721965132430.png)

然后在右边的项目里找到 Resources 双击进入，然后切换成图像，最后添加BMP图像

![72196526452](总复习.assets\1721965264521.png)

工具主要用这三个，最下面那个是画线条![72196538013](总复习.assets\1721965380136.png)

画什么样子可以参考一下

![72196545480](总复习.assets\1721965454809.png)





弧度转度分秒：

```c#
public double AngleToddmmssss(double angle)
        {
            //angle是弧度
            double temp = angle / Math.PI * 180.0 * 3600.0;
            double dd = (int)(angle / Math.PI * 180.0);
            double mm = (int)((temp - dd * 3600) / 60.0);
            double ssss = temp - dd * 3600 - mm * 60;
            return dd + mm / 100.0 + ssss / 10000.0;
        }
```



度分秒转度数：

```C#
public double ddmmssssToAngle(double ddmmssss)
        {
            double dd = (int)ddmmssss;
            double mm = (int)((ddmmssss - dd) * 100);
            double ss = ((ddmmssss - dd) * 100 - mm) * 100;
            return dd + mm / 60.0 + ss / 3600.0;
            //返回的是度数
        }
```











# 一、五点光滑法

注意下这个选择控件，需要选择闭合还是不闭合![72170655367](总复习.assets\1721706553671.png)

这个是SplitButton

![72170658265](总复习.assets\1721706582651.png)

点击添加代码，设置一个Int变量selectFalg来保存选择的状态，默认是1，1表示闭合

![72170673717](总复习.assets\1721706737175.png)







# 二、空间探索分析

详细的看代码，这个感觉比较重要

椭圆的看这个：

![72172333081](总复习.assets\1721723330813.png)

![72179139487](总复习.assets\1721791394878.png)

矩阵要双重标准化，记住：必须先行后列。

![72172568134](总复习.assets\1721725681349.png)

不过好像计算莫兰指数只要行标准化，双重标准化看看就行了

![72172585449](总复习.assets\1721725854493.png)

莫兰指数跟我的资料差不多，空间权重矩阵用距离倒数就行了。不过有个什么概率，主要是计算Z

![72172431562](总复习.assets\1721724315622.png)

Z的计算过程：![72172444941](总复习.assets\1721724449417.png)

下面那个I指的是全局莫兰指数

![72172450568](总复习.assets\1721724505689.png)







# 三、纵横断面计算

查找关键点记住了，传入的参数就这样写，而且是private。多看代码

![72181239926](总复习.assets\1721812399265.png)

纵横断面计算挺多的，好好看代码

计算横断面的时候，中间点M0，M1也要内插高程，不然计算的面积是错的![72189266365](总复习.assets\1721892663654.png)







# 四、电离层计算

计算一天中的秒数就纯计算就行了

10的几次方：1e-7，是10的负7次方。





# 五、对流层计算

年积日的计算：

```c#
#region 年积日的计算
        public static double GetDays(string line)
        {
            int year = Convert.ToInt16(line.Substring(0, 4));
            int month = Convert.ToInt16(line.Substring(4, 2));
            int days = Convert.ToInt16(line.Substring(6,2));
            DateTime dateTime = new DateTime(year, month, days);
            var dayOfYear = dateTime.DayOfYear;
            return dayOfYear;
        }
        #endregion
```

内插的简便方法：要下载包

首先在解决方案右键，管理NuGet程序包![72206485105](总复习.assets\1722064851056.png)

在里面搜索MathNet第一个就是，然后下载

![72206482117](总复习.assets\1722064821179.png)

命名空间：

![72206659914](总复习.assets\1722066599144.png)



使用方法：![72206674325](总复习.assets\1722066743252.png)